<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุฑุงุณู ุงููุงุชุณุงุจ ุงููุจุงุดุฑ - ุงูุฅุตุฏุงุฑ 2025</title>
    
    <link rel="stylesheet" href="style.css?v=20251218">
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <link rel="manifest" href="manifest.json?v=20251218">
    <link rel="shortcut icon" href="whatsapp-icon.png" type="image/png">
</head>
<body>
    
    <div class="page-wrapper" id="pageWrapper"> 
        <div class="container" id="mainContainer">
            
            <h1 class="app-heading">ูุฑุงุณู ุงููุงุชุณุงุจ ุงููุจุงุดุฑ</h1>
            <p class="description">ุฃุณุฑุน ุทุฑููุฉ ููุชูุงุตูุ ุฃุฏุฎู ุงูุฑูู ูุงุจุฏุฃ ุงููุญุงุฏุซุฉ ููุฑุงู.</p>

            <button id="installButton" class="install-prompt-button" style="display: none;">
                ๐ฒ ุชุซุจูุช ุงูุชุทุจูู
            </button>
            
            <div class="input-group">
                <label for="countryInput">ุงุฎุชุฑ ุงูุฏููุฉ ุฃู ุงูุชุจ ููุชุงุญูุง (ูุซุงู: ุงูุณูุฏุงู 249):</label>
                <input 
                    list="country-options" 
                    id="countryInput" 
                    name="country-input" 
                    placeholder="ุงุจุญุซ ุนู ุงูุฏููุฉ ุฃู ุงูุฑูุฒ (+249)" 
                    value="ุงูุณูุฏุงู (+249)"
                    onchange="updatePhoneCode(this.value)"
                >
                
                <datalist id="country-options">
                    <option value="ุงูุณูุฏุงู (+249)">
                    <option value="ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ (+966)">
                    <option value="ุงูุฅูุงุฑุงุช ุงูุนุฑุจูุฉ ุงููุชุญุฏุฉ (+971)">
                    <option value="ูุตุฑ (+20)">
                    <option value="ุงูููุงูุงุช ุงููุชุญุฏุฉ ุงูุฃูุฑูููุฉ (+1)">
                    <option value="ุงูููููุฉ ุงููุชุญุฏุฉ (+44)">
                    <option value="ุงูุฌุฒุงุฆุฑ (+213)"> 
                    <option value="ุงูุฃุฑุฏู (+962)"> 
                    <option value="ุงููููุช (+965)"> 
                    <option value="ูุทุฑ (+974)"> 
                    <option value="ุนููุงู (+968)">
                    <option value="ุงูููู (+967)">
                    <option value="ููุจูุง (+218)">
                    <option value="ุงููุบุฑุจ (+212)">
                    <option value="ููุณุทูู (+970)">
                    <option value="ุงูุนุฑุงู (+964)">
                    <option value="ุณูุฑูุง (+963)">
                    <option value="ูุจูุงู (+961)">
                    <option value="ุชููุณ (+216)">
                    <option value="ุฃูุบุงูุณุชุงู (+93)"> <option value="ุฃูุจุงููุง (+355)">
                    <option value="ุฃูุฏูุฑุง (+376)"> <option value="ุฃูุบููุง (+244)">
                    <option value="ุงูุฃุฑุฌูุชูู (+54)"> <option value="ุฃุฑููููุง (+374)">
                    <option value="ุฃุณุชุฑุงููุง (+61)"> <option value="ุงูููุณุง (+43)">
                    <option value="ุฃุฐุฑุจูุฌุงู (+994)"> <option value="ุงูุจุญุฑูู (+973)">
                    <option value="ุจูุบูุงุฏูุด (+880)"> <option value="ุจูุฌููุง (+32)">
                    <option value="ุงูุจุฑุงุฒูู (+55)"> <option value="ุจูุบุงุฑูุง (+359)">
                    <option value="ููุฏุง (+1)"> <option value="ุชุดููู (+56)">
                    <option value="ุงูุตูู (+86)"> <option value="ูููููุจูุง (+57)">
                    <option value="ูุฑูุงุชูุง (+385)"> <option value="ููุจุง (+53)">
                    <option value="ูุจุฑุต (+357)"> <option value="ุงูุฏููุงุฑู (+45)">
                    <option value="ุงูุฅููุงุฏูุฑ (+593)"> <option value="ุฅุซููุจูุง (+251)">
                    <option value="ููููุฏุง (+358)"> <option value="ูุฑูุณุง (+33)">
                    <option value="ุฃููุงููุง (+49)"> <option value="ุงููููุงู (+30)">
                    <option value="ุงูููุฏ (+91)"> <option value="ุฅูุฏูููุณูุง (+62)">
                    <option value="ุฃูุฑููุฏุง (+353)"> <option value="ุฅุณุฑุงุฆูู (+972)">
                    <option value="ุฅูุทุงููุง (+39)"> <option value="ุงููุงุจุงู (+81)">
                    <option value="ููููุง (+254)"> <option value="ููุฑูุง ุงูุฌููุจูุฉ (+82)">
                    <option value="ุงูููุณูู (+52)"> <option value="ููุฌูุฑูุง (+234)">
                    <option value="ุงููุฑููุฌ (+47)"> <option value="ุจุงูุณุชุงู (+92)">
                    <option value="ุจูุฑู (+51)"> <option value="ุงูููุจูู (+63)">
                    <option value="ุจูููุฏุง (+48)"> <option value="ุงูุจุฑุชุบุงู (+351)">
                    <option value="ุฑูุณูุง (+7)"> <option value="ุณูุบุงููุฑุฉ (+65)">
                    <option value="ุงูุตููุงู (+252)"> <option value="ุฌููุจ ุฃูุฑูููุง (+27)">
                    <option value="ุฅุณุจุงููุง (+34)"> <option value="ุงูุณููุฏ (+46)">
                    <option value="ุณููุณุฑุง (+41)"> <option value="ุชุฑููุง (+90)">
                    <option value="ุฃููุฑุงููุง (+380)"> <option value="ููุฒูููุง (+58)">
                    <option value="ุฒููุจุงุจูู (+263)">
                </datalist>
            </div>

            <div class="phone-input-container">
                <div class="country-code-wrapper">
                    <span id="currentFlag" class="flag-icon flag-icon-sd"></span>
                    <input type="tel" id="codeInput" value="+249" inputmode="numeric" disabled>
                </div>
                <input type="tel" id="phoneInput" placeholder="ุฃุฏุฎู ุงูุฑูู ุงููุญูู (ุจุฏูู ุงูุฑูุฒ)" inputmode="numeric">
            </div>

            <button id="whatsappButton" onclick="openWhatsApp()">
                <img src="whatsapp-icon.png" alt="WhatsApp Icon" class="icon"> ุจุฏุก ุงููุญุงุฏุซุฉ ุงูุขู
            </button>

            <p class="note prominent-note">ูุฑุฌู ุงูุชุฃูุฏ ูู ุตุญุฉ ุฑูุฒ ุงูุฏููุฉ ุงููุฏุฎู.</p>

            <div class="share-section">
                <p class="share-title">ุดุงุฑู ุงูุชุทุจูู ูุน ุฃุตุฏูุงุฆู:</p>
                <div class="share-icons">
                    <button class="share-btn facebook" onclick="shareApp('facebook')"><i class="fab fa-facebook-f"></i></button>
                    <button class="share-btn messenger" onclick="shareApp('messenger')"><i class="fab fa-facebook-messenger"></i></button>
                    <button class="share-btn whatsapp" onclick="shareApp('whatsapp')"><i class="fab fa-whatsapp"></i></button>
                </div>
            </div>
        </div>

        <footer class="app-footer">
            <a href="https://linktr.ee/abdul3ziz95" target="_blank" class="contact-link bold-link">๐ ุงุชุตู ุจู</a>
            <p class="copyright-text">ุฌููุน ุงูุญููู ูุญููุธุฉ ยฉ 2025. <span class="owner-name">Abdul3ziz95</span></p>
        </footer>
    </div>
    
    <script>
        const APP_LINK = 'https://abdul3ziz95.github.io/zool/';
        const SHARE_MESSAGE = 'ุฌุฑุจูุง ูุฑุงุณู ุงููุงุชุณุงุจ ุงูุณูุฏุงูู ุงูููุฑู! ุฃุณุฑุน ุทุฑููุฉ ูุจุฏุก ูุญุงุฏุซุฉ ุฏูู ุญูุธ ุงูุฑูู. ุงูุฑุงุจุท: ' + APP_LINK;

        const codeInput = document.getElementById('codeInput'); 
        const phoneInput = document.getElementById('phoneInput'); 
        const countryInput = document.getElementById('countryInput');
        const currentFlagSpan = document.getElementById('currentFlag');
        const installButton = document.getElementById('installButton');

        const countryCodes = {
            'ุงูุณูุฏุงู': 'sd', 'ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ': 'sa', 'ุงูุฅูุงุฑุงุช ุงูุนุฑุจูุฉ ุงููุชุญุฏุฉ': 'ae', 
            'ูุตุฑ': 'eg', 'ุงูููุงูุงุช ุงููุชุญุฏุฉ ุงูุฃูุฑูููุฉ': 'us', 'ุงูููููุฉ ุงููุชุญุฏุฉ': 'gb', 
            'ุงูุฌุฒุงุฆุฑ': 'dz', 'ุงูุฃุฑุฏู': 'jo', 'ุงููููุช': 'kw', 'ูุทุฑ': 'qa', 'ุนููุงู': 'om',
            'ุงูููู': 'ye', 'ููุจูุง': 'ly', 'ุงููุบุฑุจ': 'ma', 'ููุณุทูู': 'ps', 'ุงูุนุฑุงู': 'iq',
            'ุณูุฑูุง': 'sy', 'ูุจูุงู': 'lb', 'ุชููุณ': 'tn', 'ุฃูุบุงูุณุชุงู': 'af', 'ุฃูุจุงููุง': 'al',
            'ุฃูุฏูุฑุง': 'ad', 'ุฃูุบููุง': 'ao', 'ุงูุฃุฑุฌูุชูู': 'ar', 'ุฃุฑููููุง': 'am', 'ุฃุณุชุฑุงููุง': 'au',
            'ุงูููุณุง': 'at', 'ุฃุฐุฑุจูุฌุงู': 'az', 'ุงูุจุญุฑูู': 'bh', 'ุจูุบูุงุฏูุด': 'bd', 'ุจูุฌููุง': 'be',
            'ุงูุจุฑุงุฒูู': 'br', 'ุจูุบุงุฑูุง': 'bg', 'ููุฏุง': 'ca', 'ุชุดููู': 'cl', 'ุงูุตูู': 'cn',
            'ูููููุจูุง': 'co', 'ูุฑูุงุชูุง': 'hr', 'ููุจุง': 'cu', 'ูุจุฑุต': 'cy', 'ุงูุฏููุงุฑู': 'dk',
            'ุงูุฅููุงุฏูุฑ': 'ec', 'ุฅุซููุจูุง': 'et', 'ููููุฏุง': 'fi', 'ูุฑูุณุง': 'fr', 'ุฃููุงููุง': 'de',
            'ุงููููุงู': 'gr', 'ุงูููุฏ': 'in', 'ุฅูุฏูููุณูุง': 'id', 'ุฃูุฑููุฏุง': 'ie', 'ุฅุณุฑุงุฆูู': 'il',
            'ุฅูุทุงููุง': 'it', 'ุงููุงุจุงู': 'jp', 'ููููุง': 'ke', 'ููุฑูุง ุงูุฌููุจูุฉ': 'kr', 'ุงูููุณูู': 'mx',
            'ููุฌูุฑูุง': 'ng', 'ุงููุฑููุฌ': 'no', 'ุจุงูุณุชุงู': 'pk', 'ุจูุฑู': 'pe', 'ุงูููุจูู': 'ph',
            'ุจูููุฏุง': 'pl', 'ุงูุจุฑุชุบุงู': 'pt', 'ุฑูุณูุง': 'ru', 'ุณูุบุงููุฑุฉ': 'sg', 'ุงูุตููุงู': 'so',
            'ุฌููุจ ุฃูุฑูููุง': 'za', 'ุฅุณุจุงููุง': 'es', 'ุงูุณููุฏ': 'se', 'ุณููุณุฑุง': 'ch', 'ุชุฑููุง': 'tr',
            'ุฃููุฑุงููุง': 'ua', 'ููุฒูููุง': 've', 'ุฒููุจุงุจูู': 'zw'
        };


        function extractCode(value) {
            const match = value.match(/\((\+)(\d+)\)/);
            return match ? match[2] : '';
        }

        function extractName(value) {
            return value.split(' (')[0].trim();
        }

        function updatePhoneCode(selectedValue) {
            const code = extractCode(selectedValue);
            const name = extractName(selectedValue);
            
            if (code) {
                codeInput.value = `+${code}`;
                const iso = countryCodes[name];
                if (iso) {
                    currentFlagSpan.className = `flag-icon flag-icon-${iso.toLowerCase()}`;
                } else {
                    currentFlagSpan.className = `flag-icon flag-icon-un`;
                }
            } else {
                const manualCodeMatch = selectedValue.match(/^(\+?)(\d+)/);
                if (manualCodeMatch) {
                     codeInput.value = `+${manualCodeMatch[2]}`;
                     currentFlagSpan.className = `flag-icon flag-icon-un`;
                } else {
                     codeInput.value = '+249';
                     currentFlagSpan.className = `flag-icon flag-icon-sd`;
                }
            }
        }

        function openWhatsApp() {
            const code = codeInput.value.replace('+', '').trim(); 
            const localNumber = phoneInput.value.trim().replace(/[\s+-]/g, '');

            if (!code || code.length < 1 || !localNumber || localNumber.length < 6) {
                alert('ุงูุฑุฌุงุก ุฅุฏุฎุงู ุฑูุฒ ุงูุฏููุฉ ูุฑูู ูุงุชู ูุญูู ุตุงูุญ (ูุง ููู ุนู 6 ุฃุฑูุงู).');
                return;
            }

            const fullNumber = code + localNumber;
            const whatsappLink = 'https://wa.me/' + fullNumber;
            window.open(whatsappLink, '_blank');
        }

        function shareApp(platform) {
            let url = '';
            const finalLink = APP_LINK + '?source=share'; // ุฅุถุงูุฉ ูุตุฏุฑ ููุณุฑ ุงููุงุด ุฃูุถุงู
            const finalMessage = SHARE_MESSAGE.replace(APP_LINK, finalLink);
            switch (platform) {
                case 'whatsapp':
                    url = `https://wa.me/?text=${encodeURIComponent(finalMessage)}`;
                    break;
                case 'messenger':
                    url = `https://www.facebook.com/dialog/send?link=${encodeURIComponent(finalLink)}&app_id=1234567890&redirect_uri=${encodeURIComponent(finalLink)}`;
                    break;
                case 'facebook':
                    url = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(finalLink)}`;
                    break;
                default:
                    return;
            }
            window.open(url, '_blank', 'width=600,height=400');
        }
        
        // ** ุงูุชุนุฏูู ุงูุฌุฐุฑู ูู ูุธููุฉ initializeApp **
        function initializeApp() {
            // ** 1. ุญู ูุดููุฉ ุงูุงุฑุชูุงุน (vh fix) **
            function setVhProperty() {
                let vh = window.innerHeight * 0.01;
                document.documentElement.style.setProperty('--vh', `${vh}px`);
                document.getElementById('pageWrapper').style.transform = 'translateZ(0)';
            }
            setVhProperty();
            window.addEventListener('resize', setVhProperty);
            
            // ** 2. ุฅุฌุจุงุฑ ุฅูุบุงุก ุชุณุฌูู Service Worker ุงููุฏูู (PWA fix) **
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistrations().then(function(registrations) {
                    for(let registration of registrations) {
                        if(registration.scope.includes('/zool/')) {
                           registration.unregister().then(() => {
                                console.log('Service Worker for /zool/ unregistered successfully.');
                           }).catch((err) => {
                                console.error('Failed to unregister Service Worker:', err);
                           });
                        }
                    }
                });
                
                // ุชุณุฌูู Service Worker ุงูุฌุฏูุฏ ุจุนุฏ ุงูุญุฐู
                 navigator.serviceWorker.register('/zool/sw.js?v=20251218', { scope: '/zool/' }) 
                    .catch((err) => { console.log('SW registration failed (new version):', err); });
            }
            
            // ุชููุฆุฉ ุฒุฑ ุงูุชุซุจูุช
            let deferredPrompt; 
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e; 
                installButton.style.display = 'block'; 
            });

            installButton.addEventListener('click', () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    deferredPrompt.userChoice.then((choiceResult) => {
                        if (choiceResult.outcome === 'accepted') {
                            installButton.style.display = 'none'; 
                        }
                        deferredPrompt = null; 
                    });
                } else {
                    alert('ูุชุซุจูุช ุงูุชุทุจูู: ุงูุชุญ ูุงุฆูุฉ ุงููุชุตูุญ (โฎ) ูุงุฎุชุฑ "ุงูุชุซุจูุช".');
                }
            });
        }

        window.addEventListener('load', initializeApp);

        window.openWhatsApp = openWhatsApp;
        window.shareApp = shareApp;
        window.updatePhoneCode = updatePhoneCode;
    </script>
</body>
</html>

